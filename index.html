<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èŒæ–°MTRæœåŠ¡å™¨</title>
    <style>
        /* ç§»åŠ¨è®¾å¤‡æç¤ºæ ·å¼ */
        .mobile-notice {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0B58A2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100000;
            color: white;
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .mobile-notice h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .mobile-notice p {
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .mobile-notice .countdown {
            font-size: 20px;
            font-weight: bold;
            margin-top: 20px;
            color: #FFD700;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1E5799 0%, #207CCA 51%, #2989D8 100%);
            height: 100vh;
            overflow: hidden;
            position: relative;
            cursor: default;
        }
        
        /* æ¡Œé¢èƒŒæ™¯ */
        .desktop {
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4MCIgaGVpZ2h0PSI3MjAiIHZpZXdCb3g9IjAgMCAxMjgwIDcyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMEgxMjgwVjcyMEgwVjBaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXIpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXIiIHgxPSI2NDAiIHkxPSIwIiB4Mj0iNjQwIiB5Mj0iNzIwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiMyMDc5Q0EiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDIyRTY0Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+');
            background-size: cover;
            position: relative;
            overflow: hidden;
        }
        
        /* æ°´å° */
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            color: rgba(255, 255, 255, 0.1);
            font-size: 60px;
            font-weight: bold;
            white-space: nowrap;
            z-index: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-align: center;
            line-height: 1.2;
        }
        
        .watermark span {
            display: block;
            text-align: center;
        }
        
        /* ä»»åŠ¡æ  */
        .taskbar {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40px;
            background: linear-gradient(to bottom, #0B58A2 0%, #0A4A8C 50%, #093C75 100%);
            border-top: 1px solid #1E90FF;
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 1000;
        }
        
        /* å¼€å§‹æŒ‰é’® */
        .start-button {
            width: 80px;
            height: 30px;
            background: linear-gradient(to bottom, #60B53F 0%, #3D8C3D 50%, #2D6B2D 100%);
            border: 1px solid #7AC142;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            margin-right: 10px;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.2);
        }
        
        .start-button:hover {
            background: linear-gradient(to bottom, #7AC142 0%, #4FA64F 50%, #3D8C3D 100%);
        }
        
        .start-button:active {
            background: linear-gradient(to bottom, #2D6B2D 0%, #3D8C3D 50%, #60B53F 100%);
            box-shadow: inset 0 2px 3px rgba(0,0,0,0.2);
        }
        
        /* ä»»åŠ¡æ å›¾æ ‡ - ä»…ä¿ç•™æµè§ˆå™¨ */
        .taskbar-icons {
            display: flex;
            gap: 8px;
            flex-grow: 1;
        }
        
        .taskbar-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(to bottom, #3A7AD9 0%, #2E62B3 100%);
            border: 1px solid #4A8CE3;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .taskbar-icon:hover {
            background: linear-gradient(to bottom, #4A8CE3 0%, #3A7AD9 100%);
        }
        
        /* ç³»ç»Ÿæ‰˜ç›˜ */
        .system-tray {
            display: flex;
            align-items: center;
            gap: 5px;
            color: white;
            font-size: 11px;
        }
        
        .time {
            padding: 0 10px;
        }
        
        /* çª—å£æ ·å¼ */
        .window {
            position: absolute;
            min-width: 300px;
            min-height: 200px;
            background: linear-gradient(to bottom, #F1F1F1 0%, #E5E5E5 100%);
            border: 1px solid #A5A5A5;
            border-radius: 6px 6px 0 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
            z-index: 100;
            transition: all 0.2s;
            touch-action: none; /* é˜²æ­¢ç§»åŠ¨è®¾å¤‡ä¸Šçš„é»˜è®¤è§¦æ‘¸è¡Œä¸º */
        }
        
        .window.maximized {
            width: 100% !important;
            height: calc(100% - 40px) !important;
            top: 0 !important;
            left: 0 !important;
            border-radius: 0;
        }
        
        /* çª—å£æ ‡é¢˜æ  */
        .title-bar {
            height: 30px;
            background: linear-gradient(to bottom, #EBEBEB 0%, #D5D5D5 100%);
            border-bottom: 1px solid #A5A5A5;
            display: flex;
            align-items: center;
            padding: 0 10px;
            cursor: move;
            position: relative;
            user-select: none;
            touch-action: none;
        }
        
        .window-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            font-size: 14px;
        }
        
        .window-title {
            flex-grow: 1;
            color: #333;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* çª—å£æ§åˆ¶æŒ‰é’® - å»æ‰æœ€å°åŒ–æŒ‰é’® */
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .control-btn {
            width: 22px;
            height: 22px;
            border: 1px solid #A5A5A5;
            background: linear-gradient(to bottom, #F5F5F5 0%, #E5E5E5 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            color: #333;
            transition: all 0.2s;
            touch-action: manipulation;
        }
        
        .control-btn:hover {
            background: linear-gradient(to bottom, #E5E5E5 0%, #D5D5D5 100%);
        }
        
        .control-btn.close:hover {
            background: linear-gradient(to bottom, #E81123 0%, #F1707A 100%);
            color: white;
        }
        
        /* çª—å£å†…å®¹ */
        .window-content {
            padding: 20px;
            height: calc(100% - 30px);
            overflow: auto;
        }
        
        /* æ¡Œé¢å›¾æ ‡ - ä»…ä¿ç•™æµè§ˆå™¨ */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 1;
        }
        
        .desktop-icon {
            width: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            font-size: 12px;
            text-align: center;
            padding: 5px;
            border-radius: 3px;
            transition: all 0.2s;
        }
        
        .desktop-icon:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .desktop-icon.selected {
            background: rgba(255,255,255,0.3);
        }
        
        .icon-image {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #4A90E2 0%, #2E62B3 100%);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-bottom: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* å¼€å§‹èœå• */
        .start-menu {
            position: absolute;
            bottom: 40px;
            left: 10px;
            width: 400px;
            height: 500px;
            background: linear-gradient(to bottom, #2C2C2C 0%, #1A1A1A 100%);
            border: 1px solid #000;
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            z-index: 1001;
            overflow: hidden;
        }
        
        .start-menu.active {
            display: block;
        }
        
        .user-panel {
            height: 80px;
            background: linear-gradient(to right, #0B58A2 0%, #083E6B 100%);
            padding: 15px;
            display: flex;
            align-items: center;
            color: white;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #4A90E2 0%, #2E62B3 100%);
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .program-list {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            height: calc(100% - 80px);
            overflow-y: auto;
        }
        
        .program-item {
            padding: 10px;
            color: white;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.2s;
        }
        
        .program-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        /* Alt+Tab è¦†ç›–å±‚ */
        .alt-tab-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .alt-tab-overlay.active {
            display: flex;
        }
        
        /* ä¸Šä¸‹æ–‡èœå• - ä»…ä¿ç•™å…³äºæŒ‰é’® */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #A5A5A5;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            min-width: 150px;
            z-index: 10000;
        }
        
        .context-menu-item {
            padding: 8px 20px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
            border-bottom: 1px solid #eee;
        }
        
        .context-menu-item:hover {
            background: #E3F2FD;
        }
        
        /* æµè§ˆå™¨ç‰¹å®šæ ·å¼ */
        .browser-content {
            padding: 0;
            height: calc(100% - 30px);
            width: 100%;
        }
        
        .browser-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }
        
        .ie-title {
            color: #0066CC;
            font-weight: bold;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0B58A2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s;
        }
        
        .loading-logo {
            font-size: 48px;
            margin-bottom: 20px;
            color: white;
        }
        
        .loading-bar {
            width: 300px;
            height: 3px;
            background: rgba(255,255,255,0.2);
            overflow: hidden;
            border-radius: 3px;
        }
        
        .loading-progress {
            width: 0%;
            height: 100%;
            background: white;
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        .loading-text {
            color: white;
            margin-top: 10px;
            font-size: 14px;
        }
        
        /* çª—å£åŠ¨ç”» */
        @keyframes windowOpen {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        
        .window.open {
            animation: windowOpen 0.2s ease-out;
        }
        
        .window.closing {
            animation: shake 0.5s ease-in-out;
        }
        
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: #E5E5E5;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #A5A5A5 0%, #8C8C8C 100%);
            border-radius: 6px;
            border: 3px solid #E5E5E5;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #8C8C8C 0%, #737373 100%);
        }
        
        /* è°ƒæ•´å¤§å°çš„æ‰‹æŸ„ - æ”¹è¿›æ ·å¼ */
        .resize-handle {
            position: absolute;
            background: transparent;
            z-index: 1000;
            touch-action: none;
        }
        
        .resize-handle-top {
            top: 0;
            left: 5px;
            right: 5px;
            height: 5px;
            cursor: n-resize;
        }
        
        .resize-handle-bottom {
            bottom: 0;
            left: 5px;
            right: 5px;
            height: 5px;
            cursor: s-resize;
        }
        
        .resize-handle-left {
            top: 5px;
            left: 0;
            width: 5px;
            bottom: 5px;
            cursor: w-resize;
        }
        
        .resize-handle-right {
            top: 5px;
            right: 0;
            width: 5px;
            bottom: 5px;
            cursor: e-resize;
        }
        
        .resize-handle-topleft {
            top: 0;
            left: 0;
            width: 15px;
            height: 15px;
            cursor: nw-resize;
        }
        
        .resize-handle-topright {
            top: 0;
            right: 0;
            width: 15px;
            height: 15px;
            cursor: ne-resize;
        }
        
        .resize-handle-bottomleft {
            bottom: 0;
            left: 0;
            width: 15px;
            height: 15px;
            cursor: sw-resize;
        }
        
        .resize-handle-bottomright {
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            cursor: se-resize;
        }
        
        /* ç§»åŠ¨è®¾å¤‡é€‚é… */
        @media (max-width: 768px) {
            .desktop {
                display: none;
            }
            
            .mobile-notice {
                display: flex;
            }
            
            .window {
                min-width: 200px;
                min-height: 150px;
            }
            
            .title-bar {
                height: 40px;
                font-size: 14px;
            }
            
            .control-btn {
                width: 30px;
                height: 30px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- ç§»åŠ¨è®¾å¤‡æç¤º -->
    <div class="mobile-notice" id="mobileNotice">
        <h2>ğŸ“± æ‰‹æœºç‰ˆæç¤º</h2>
        <p>æ‰‹æœºç‰ˆæ— æ³•è®¿é—®æ¡Œé¢å½©è›‹</p>
        <p>æ­£åœ¨ä¸ºæ‚¨è·³è½¬åˆ°ä¸»é¡µ...</p>
        <div class="countdown" id="countdown">3</div>
    </div>

    <!-- åŠ è½½å±å¹• -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-logo">å¯åŠ¨ä¸­</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
        <div class="loading-text" id="loadingText">æ­£åœ¨å¯åŠ¨ç³»ç»Ÿ...</div>
    </div>

    <!-- æ¡Œé¢æ°´å° -->
    <div class="watermark">
        <span>MTRå»ºè®¾æœåŠ¡å™¨</span>
        <span>èŠ’ç‰¹çœæœåŠ¡å™¨</span>
    </div>

    <div class="desktop" id="desktop">
        <!-- Alt+Tab è¦†ç›–å±‚ -->
        <div class="alt-tab-overlay" id="altTabOverlay">
            <div style="background: rgba(255,255,255,0.9); padding: 30px; border-radius: 10px; max-width: 80%;">
                <h3 style="color: #0B58A2; margin-bottom: 20px;">Alt+Tab - åˆ‡æ¢çª—å£</h3>
                <div style="display: flex; flex-wrap: wrap; gap: 15px;" id="altTabWindows"></div>
                <div style="margin-top: 20px; color: #666; font-size: 12px;">
                    ä½¿ç”¨ Tab é”®é€‰æ‹©ï¼Œé‡Šæ”¾ Alt é”®ç¡®è®¤
                </div>
            </div>
        </div>
        
        <!-- å¼€å§‹èœå• -->
        <div class="start-menu" id="startMenu">
            <div class="user-panel">
                <div class="user-avatar">MTR</div>
                <div>
                    <div style="font-size: 14px; font-weight: bold;">èŒæ–°MTRæœåŠ¡å™¨</div>
                    <div style="font-size: 11px; opacity: 0.8;">çª—å£æ¨¡æ‹Ÿå™¨</div>
                </div>
            </div>
            <div class="program-list" id="startMenuPrograms">
                <!-- ç¨‹åºåˆ—è¡¨ç”± JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- ä»»åŠ¡æ  -->
        <div class="taskbar">
            <div class="start-button" id="startButton">
                <span>å¼€å§‹</span>
            </div>
            <div class="taskbar-icons" id="taskbarIcons">
                <!-- ä»…ä¿ç•™æµè§ˆå™¨å›¾æ ‡ -->
                <div class="taskbar-icon" onclick="launchApp('browser')" title="Internet Explorer 11">ğŸŒ</div>
            </div>
            <div class="system-tray">
                <div class="time" id="clock">13:37</div>
            </div>
        </div>
    </div>

    <script>
        // ==================== ç§»åŠ¨è®¾å¤‡æ£€æµ‹ ====================
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }
        
        // å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œæ˜¾ç¤ºæç¤ºå¹¶è·³è½¬
        if (isMobileDevice()) {
            document.getElementById('mobileNotice').style.display = 'flex';
            document.getElementById('desktop').style.display = 'none';
            
            let countdown = 3;
            const countdownElement = document.getElementById('countdown');
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    window.location.href = 'https://cunchengmtr.cloud/home';
                }
            }, 1000);
            
            // 3ç§’åè‡ªåŠ¨è·³è½¬
            setTimeout(() => {
                window.location.href = 'https://cunchengmtr.cloud/home';
            }, 3000);
        }
        
        // ==================== ç³»ç»Ÿåˆå§‹åŒ– ====================
        let windowCount = 0;
        let activeWindow = null;
        let windows = {};
        let altPressed = false;
        let tabPressed = false;
        
        // åº”ç”¨æ•°æ®åº“ - ä»…ä¿ç•™æµè§ˆå™¨
        const realApps = {
            'browser': {
                name: 'Internet Explorer 11',
                exe: 'iexplore.exe',
                icon: 'ğŸŒ',
                type: 'internet',
                launch: function() {
                    createBrowserWindow();
                }
            }
        };
        
        // æ¡Œé¢å¿«æ·æ–¹å¼é…ç½® - ä»…ä¿ç•™æµè§ˆå™¨
        const desktopShortcuts = [
            { app: 'browser', name: 'Internet Explorer', position: 0 }
        ];
        
        // å¼€å§‹èœå•ç¨‹åºé…ç½® - ä»…ä¿ç•™æµè§ˆå™¨
        const startMenuPrograms = [
            { category: 'ç¨‹åº', apps: ['browser'] }
        ];
        
        // ==================== åˆå§‹åŒ–å‡½æ•° ====================
        function init() {
            // å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œä¸åˆå§‹åŒ–æ¡Œé¢
            if (isMobileDevice()) return;
            
            updateClock();
            createDesktopIcons();
            createStartMenu();
            setupEventListeners();
            
            // æ¨¡æ‹Ÿå¯åŠ¨è¿‡ç¨‹
            setTimeout(() => {
                document.getElementById('loadingText').textContent = 'æ­£åœ¨åŠ è½½æ¡Œé¢...';
                document.getElementById('loadingProgress').style.width = '50%';
            }, 500);
            
            setTimeout(() => {
                document.getElementById('loadingText').textContent = 'æ­£åœ¨å‡†å¤‡æ¡Œé¢...';
                document.getElementById('loadingProgress').style.width = '80%';
            }, 1000);
            
            setTimeout(() => {
                document.getElementById('loadingText').textContent = 'æ­£åœ¨å¯åŠ¨ç³»ç»ŸæœåŠ¡...';
                document.getElementById('loadingProgress').style.width = '100%';
            }, 1500);
            
            setTimeout(() => {
                document.getElementById('loadingScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                }, 500);
            }, 2000);
        }
        
        // ==================== æ ¸å¿ƒåŠŸèƒ½ ====================
        
        // å¯åŠ¨åº”ç”¨ç¨‹åº
        function launchApp(appId) {
            const app = realApps[appId];
            if (app && typeof app.launch === 'function') {
                app.launch();
            }
        }
        
        // åˆ›å»ºæ¡Œé¢å›¾æ ‡
        function createDesktopIcons() {
            const desktop = document.getElementById('desktop');
            const iconsContainer = document.createElement('div');
            iconsContainer.className = 'desktop-icons';
            iconsContainer.id = 'desktopIcons';
            
            desktopShortcuts.forEach(shortcut => {
                const app = realApps[shortcut.app];
                if (!app) return;
                
                const icon = document.createElement('div');
                icon.className = 'desktop-icon';
                icon.innerHTML = `
                    <div class="icon-image">${app.icon}</div>
                    <span>${shortcut.name || app.name}</span>
                `;
                icon.style.top = `${20 + shortcut.position * 80}px`;
                icon.style.position = 'absolute';
                
                // ç§»åŠ¨è®¾å¤‡ä½¿ç”¨ touch äº‹ä»¶
                if (isMobileDevice()) {
                    icon.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        icon.classList.add('selected');
                        setTimeout(() => icon.classList.remove('selected'), 200);
                        launchApp(shortcut.app);
                    });
                } else {
                    icon.onclick = () => {
                        icon.classList.add('selected');
                        setTimeout(() => icon.classList.remove('selected'), 200);
                        launchApp(shortcut.app);
                    };
                }
                
                // æ·»åŠ å³é”®èœå•æ”¯æŒ
                icon.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    showContextMenu(e, shortcut.app, icon);
                });
                
                iconsContainer.appendChild(icon);
            });
            
            desktop.appendChild(iconsContainer);
        }
        
        // åˆ›å»ºå¼€å§‹èœå•
        function createStartMenu() {
            const startMenu = document.getElementById('startMenuPrograms');
            
            startMenuPrograms.forEach(section => {
                const sectionElement = document.createElement('div');
                sectionElement.style.gridColumn = '1 / -1';
                sectionElement.style.marginTop = '10px';
                sectionElement.style.marginBottom = '5px';
                sectionElement.style.color = '#888';
                sectionElement.style.fontSize = '11px';
                sectionElement.textContent = section.category;
                startMenu.appendChild(sectionElement);
                
                section.apps.forEach(appId => {
                    const app = realApps[appId];
                    if (!app) return;
                    
                    const programItem = document.createElement('div');
                    programItem.className = 'program-item';
                    programItem.innerHTML = `
                        <strong>${app.name}</strong>
                        <div style="font-size: 11px; opacity: 0.8;">${app.exe}</div>
                    `;
                    
                    if (isMobileDevice()) {
                        programItem.addEventListener('touchstart', (e) => {
                            e.preventDefault();
                            document.getElementById('startMenu').classList.remove('active');
                            launchApp(appId);
                        });
                    } else {
                        programItem.onclick = () => {
                            document.getElementById('startMenu').classList.remove('active');
                            launchApp(appId);
                        };
                    }
                    
                    startMenu.appendChild(programItem);
                });
            });
        }
        
        // åˆ›å»ºæµè§ˆå™¨çª—å£
        function createBrowserWindow() {
            windowCount++;
            const windowId = `window_${windowCount}`;
            
            const windowEl = document.createElement('div');
            windowEl.className = 'window open';
            windowEl.id = windowId;
            windowEl.style.top = '50px';
            windowEl.style.left = '50px';
            windowEl.style.width = '800px';
            windowEl.style.height = '600px';
            
            windowEl.innerHTML = `
                <div class="title-bar" id="${windowId}_titlebar">
                    <div class="window-icon ie-title">IE</div>
                    <div class="window-title">èŠ’ç‰¹çœ (ç‰é‡‘å¸‚/æ‘åº„åŸ)</div>
                    <div class="window-controls">
                        <div class="control-btn maximize">â–¡</div>
                        <div class="control-btn close">Ã—</div>
                    </div>
                </div>
                <div class="window-content">
                    <div style="width: 100%; height: 100%; padding: 20px; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                        <h2 style="color: #0B58A2; margin-bottom: 20px;">èŠ’ç‰¹çœ (ç‰é‡‘å¸‚/æ‘åº„åŸ)</h2>
                        <p style="margin-bottom: 30px; font-size: 16px;">è¿™ä¸ªç•Œé¢å¥½ç©å—ï¼Ÿ</p>
                        <p style="margin-bottom: 40px; font-size: 14px; color: #666;">ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æ‰ä¼šè·³è½¬åˆ°çœŸæ­£çš„æ‘åº„åŸç½‘é¡µ</p>
                        <button onclick="openRealBrowser()" style="
                            padding: 12px 30px;
                            background: linear-gradient(to bottom, #3A7AD9 0%, #2E62B3 100%);
                            color: white;
                            border: none;
                            border-radius: 4px;
                            font-size: 14px;
                            font-weight: bold;
                            cursor: pointer;
                            box-shadow: 0 3px 5px rgba(0,0,0,0.2);
                        ">æ‰“å¼€çœŸæ­£çš„æ‘åº„åŸç½‘é¡µ</button>
                        <p style="margin-top: 40px; font-size: 12px; color: #888;">ç‚¹å‡»åå°†ä¼šæ‰“å¼€Internet Explorer 11æµè§ˆå™¨</p>
                    </div>
                </div>
            `;
            
            document.getElementById('desktop').appendChild(windowEl);
            
            // åˆå§‹åŒ–çª—å£æ•°æ®
            windows[windowId] = {
                element: windowEl,
                type: 'browser',
                minimized: false,
                maximized: false,
                resizable: true,
                originalSize: {
                    width: '800px',
                    height: '600px'
                },
                originalPosition: {
                    top: '50px',
                    left: '50px'
                }
            };
            
            // è®¾ç½®çª—å£åŠŸèƒ½
            setupWindowFunctionality(windowEl, windowId);
            
            return windowId;
        }
        
        // è®¾ç½®çª—å£åŠŸèƒ½ï¼ˆæ‹–åŠ¨ã€è°ƒæ•´å¤§å°ã€æŒ‰é’®ï¼‰
        function setupWindowFunctionality(windowEl, windowId) {
            const windowData = windows[windowId];
            if (!windowData) return;
            
            // 1. è®¾ç½®çª—å£æ‹–åŠ¨
            setupWindowDrag(windowEl, `${windowId}_titlebar`);
            
            // 2. è®¾ç½®çª—å£æ§åˆ¶æŒ‰é’®
            setupWindowControls(windowEl, windowId);
            
            // 3. å¦‚æœçª—å£å¯è°ƒæ•´å¤§å°ï¼Œæ·»åŠ è°ƒæ•´å¤§å°æ‰‹æŸ„
            if (windowData.resizable) {
                addResizeHandles(windowEl);
            }
            
            // 4. çª—å£ç‚¹å‡»ç½®é¡¶
            if (isMobileDevice()) {
                windowEl.addEventListener('touchstart', (e) => {
                    if (e.target.closest('.title-bar')) return;
                    bringToFront(windowId);
                });
            } else {
                windowEl.addEventListener('mousedown', (e) => {
                    if (e.target.closest('.title-bar')) return;
                    bringToFront(windowId);
                });
            }
            
            // 5. åˆå§‹åŒ–çª—å£çŠ¶æ€
            bringToFront(windowId);
        }
        
        // ä¸ºçª—å£æ·»åŠ è°ƒæ•´å¤§å°æ‰‹æŸ„
        function addResizeHandles(windowEl) {
            const handles = [
                {class: 'resize-handle-top', cursor: 'n-resize'},
                {class: 'resize-handle-bottom', cursor: 's-resize'},
                {class: 'resize-handle-left', cursor: 'w-resize'},
                {class: 'resize-handle-right', cursor: 'e-resize'},
                {class: 'resize-handle-topleft', cursor: 'nw-resize'},
                {class: 'resize-handle-topright', cursor: 'ne-resize'},
                {class: 'resize-handle-bottomleft', cursor: 'sw-resize'},
                {class: 'resize-handle-bottomright', cursor: 'se-resize'}
            ];
            
            handles.forEach(handle => {
                const handleEl = document.createElement('div');
                handleEl.className = handle.class;
                handleEl.style.cursor = handle.cursor;
                windowEl.appendChild(handleEl);
                
                // ä¸ºæ¯ä¸ªæ‰‹æŸ„æ·»åŠ è°ƒæ•´å¤§å°åŠŸèƒ½
                setupResizeHandle(handleEl, windowEl, handle.class);
            });
        }
        
        // è®¾ç½®è°ƒæ•´å¤§å°æ‰‹æŸ„åŠŸèƒ½ - ä¿®å¤å®½åº¦è°ƒæ•´é—®é¢˜
        function setupResizeHandle(handle, windowEl, handleClass) {
            let isResizing = false;
            let startX, startY;
            let startWidth, startHeight;
            let startLeft, startTop;
            
            const startResize = (clientX, clientY) => {
                isResizing = true;
                startX = clientX;
                startY = clientY;
                startWidth = windowEl.offsetWidth;
                startHeight = windowEl.offsetHeight;
                startLeft = windowEl.offsetLeft;
                startTop = windowEl.offsetTop;
                
                // é˜²æ­¢é€‰ä¸­æ–‡æœ¬
                document.body.style.userSelect = 'none';
                document.body.style.webkitUserSelect = 'none';
            };
            
            const doResize = (clientX, clientY) => {
                if (!isResizing) return;
                
                const deltaX = clientX - startX;
                const deltaY = clientY - startY;
                
                // è®¡ç®—æœ€å°å°ºå¯¸
                const minWidth = 300;
                const minHeight = 200;
                
                // å¤„ç†å·¦å³è°ƒæ•´
                if (handleClass.includes('right') || handleClass.includes('topright') || handleClass.includes('bottomright')) {
                    const newWidth = Math.max(minWidth, startWidth + deltaX);
                    windowEl.style.width = newWidth + 'px';
                }
                
                // å¤„ç†å·¦ä¾§è°ƒæ•´
                if (handleClass.includes('left') || handleClass.includes('topleft') || handleClass.includes('bottomleft')) {
                    const newWidth = Math.max(minWidth, startWidth - deltaX);
                    const newLeft = startLeft + deltaX;
                    windowEl.style.width = newWidth + 'px';
                    windowEl.style.left = newLeft + 'px';
                }
                
                // å¤„ç†ä¸Šä¸‹è°ƒæ•´
                if (handleClass.includes('bottom') || handleClass.includes('bottomleft') || handleClass.includes('bottomright')) {
                    const newHeight = Math.max(minHeight, startHeight + deltaY);
                    windowEl.style.height = newHeight + 'px';
                }
                
                // å¤„ç†é¡¶éƒ¨è°ƒæ•´
                if (handleClass.includes('top') || handleClass.includes('topleft') || handleClass.includes('topright')) {
                    const newHeight = Math.max(minHeight, startHeight - deltaY);
                    const newTop = startTop + deltaY;
                    windowEl.style.height = newHeight + 'px';
                    windowEl.style.top = newTop + 'px';
                }
            };
            
            const stopResize = () => {
                isResizing = false;
                document.body.style.userSelect = '';
                document.body.style.webkitUserSelect = '';
            };
            
            // ç§»åŠ¨è®¾å¤‡ä½¿ç”¨ touch äº‹ä»¶
            if (isMobileDevice()) {
                handle.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    startResize(touch.clientX, touch.clientY);
                });
                
                document.addEventListener('touchmove', (e) => {
                    if (!isResizing) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    doResize(touch.clientX, touch.clientY);
                });
                
                document.addEventListener('touchend', stopResize);
                document.addEventListener('touchcancel', stopResize);
            } else {
                handle.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    startResize(e.clientX, e.clientY);
                    
                    const handleMouseMove = (moveEvent) => {
                        doResize(moveEvent.clientX, moveEvent.clientY);
                    };
                    
                    const handleMouseUp = () => {
                        stopResize();
                        document.removeEventListener('mousemove', handleMouseMove);
                        document.removeEventListener('mouseup', handleMouseUp);
                    };
                    
                    document.addEventListener('mousemove', handleMouseMove);
                    document.addEventListener('mouseup', handleMouseUp);
                });
            }
        }
        
        // æ‰“å¼€çœŸæ­£çš„æµè§ˆå™¨çª—å£ - ä¿®æ”¹ä¸»é¡µé“¾æ¥
        function openRealBrowser() {
            windowCount++;
            const windowId = `window_${windowCount}`;
            
            const windowEl = document.createElement('div');
            windowEl.className = 'window open';
            windowEl.id = windowId;
            windowEl.style.top = '80px';
            windowEl.style.left = '80px';
            windowEl.style.width = '900px';
            windowEl.style.height = '650px';
            
            windowEl.innerHTML = `
                <div class="title-bar" id="${windowId}_titlebar">
                    <div class="window-icon ie-title">IE</div>
                    <div class="window-title">Internet Explorer 11 - https://cunchengmtr.cloud/home</div>
                    <div class="window-controls">
                        <div class="control-btn maximize">â–¡</div>
                        <div class="control-btn close">Ã—</div>
                    </div>
                </div>
                <div class="window-content" style="padding: 0; height: calc(100% - 30px);">
                    <iframe class="browser-frame" src="https://cunchengmtr.cloud/home" title="èŠ’ç‰¹çœMTRæœåŠ¡å™¨" style="width: 100%; height: 100%; border: none;"></iframe>
                </div>
            `;
            
            document.getElementById('desktop').appendChild(windowEl);
            
            // åˆå§‹åŒ–çª—å£æ•°æ®
            windows[windowId] = {
                element: windowEl,
                type: 'real-browser',
                minimized: false,
                maximized: false,
                resizable: true,
                originalSize: {
                    width: '900px',
                    height: '650px'
                },
                originalPosition: {
                    top: '80px',
                    left: '80px'
                }
            };
            
            // è®¾ç½®çª—å£åŠŸèƒ½
            setupWindowFunctionality(windowEl, windowId);
            
            return windowId;
        }
        
        // ==================== çª—å£ç®¡ç†ç³»ç»Ÿ ====================
        
        // çª—å£æ‹–æ‹½åŠŸèƒ½ - æ”¯æŒç§»åŠ¨è®¾å¤‡
        function setupWindowDrag(windowEl, titlebarId) {
            const titlebar = document.getElementById(titlebarId);
            let isDragging = false;
            let offsetX, offsetY;
            
            const startDrag = (clientX, clientY) => {
                const windowId = windowEl.id;
                const windowData = windows[windowId];
                
                if (!windowData) return;
                
                // å¦‚æœçª—å£å·²ç»æœ€å¤§åŒ–ï¼Œåˆ™å…ˆæ¢å¤åŸçŠ¶
                if (windowData.maximized) {
                    maximizeWindow(windowId);
                    // æ›´æ–°æ‹–åŠ¨åç§»é‡
                    const rect = windowEl.getBoundingClientRect();
                    offsetX = clientX - rect.width / 2;
                    offsetY = clientY - 15; // æ ‡é¢˜æ é«˜åº¦çš„ä¸€åŠ
                } else {
                    const rect = windowEl.getBoundingClientRect();
                    offsetX = clientX - rect.left;
                    offsetY = clientY - rect.top;
                }
                
                isDragging = true;
                bringToFront(windowId);
                
                // é˜²æ­¢é€‰ä¸­æ–‡æœ¬
                document.body.style.userSelect = 'none';
                document.body.style.webkitUserSelect = 'none';
            };
            
            const doDrag = (clientX, clientY) => {
                if (!isDragging) return;
                
                windowEl.style.left = `${clientX - offsetX}px`;
                windowEl.style.top = `${clientY - offsetY}px`;
            };
            
            const stopDrag = () => {
                isDragging = false;
                document.body.style.userSelect = '';
                document.body.style.webkitUserSelect = '';
            };
            
            // ç§»åŠ¨è®¾å¤‡ä½¿ç”¨ touch äº‹ä»¶
            if (isMobileDevice()) {
                titlebar.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    startDrag(touch.clientX, touch.clientY);
                });
                
                document.addEventListener('touchmove', (e) => {
                    if (!isDragging) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    doDrag(touch.clientX, touch.clientY);
                });
                
                document.addEventListener('touchend', stopDrag);
                document.addEventListener('touchcancel', stopDrag);
            } else {
                titlebar.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    startDrag(e.clientX, e.clientY);
                    
                    const handleMouseMove = (moveEvent) => {
                        doDrag(moveEvent.clientX, moveEvent.clientY);
                    };
                    
                    const handleMouseUp = () => {
                        stopDrag();
                        document.removeEventListener('mousemove', handleMouseMove);
                        document.removeEventListener('mouseup', handleMouseUp);
                    };
                    
                    document.addEventListener('mousemove', handleMouseMove);
                    document.addEventListener('mouseup', handleMouseUp);
                });
            }
        }
        
        // çª—å£æ§åˆ¶æŒ‰é’®åŠŸèƒ½ - å»æ‰æœ€å°åŒ–æŒ‰é’®
        function setupWindowControls(windowEl, windowId) {
            const controls = windowEl.querySelector('.window-controls');
            const windowData = windows[windowId];
            
            if (!windowData) return;
            
            // æœ€å¤§åŒ–æŒ‰é’®
            const maximizeBtn = controls.querySelector('.maximize');
            if (maximizeBtn) {
                if (isMobileDevice()) {
                    maximizeBtn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        maximizeWindow(windowId);
                    });
                } else {
                    maximizeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        maximizeWindow(windowId);
                    });
                }
            }
            
            // å…³é—­æŒ‰é’®
            const closeBtn = controls.querySelector('.close');
            if (closeBtn) {
                if (isMobileDevice()) {
                    closeBtn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        closeWindow(windowId);
                    });
                } else {
                    closeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        closeWindow(windowId);
                    });
                }
            }
        }
        
        // çª—å£æ“ä½œå‡½æ•°
        function maximizeWindow(windowId) {
            const windowData = windows[windowId];
            if (windowData && windowData.resizable) {
                if (windowData.maximized) {
                    // æ¢å¤çª—å£
                    windowData.element.classList.remove('maximized');
                    windowData.element.style.width = windowData.originalSize.width;
                    windowData.element.style.height = windowData.originalSize.height;
                    windowData.element.style.top = windowData.originalPosition.top;
                    windowData.element.style.left = windowData.originalPosition.left;
                    windowData.maximized = false;
                } else {
                    // ä¿å­˜å½“å‰å¤§å°å’Œä½ç½®
                    windowData.originalSize = {
                        width: windowData.element.style.width || windowData.element.offsetWidth + 'px',
                        height: windowData.element.style.height || windowData.element.offsetHeight + 'px'
                    };
                    windowData.originalPosition = {
                        top: windowData.element.style.top || windowData.element.offsetTop + 'px',
                        left: windowData.element.style.left || windowData.element.offsetLeft + 'px'
                    };
                    
                    // æœ€å¤§åŒ–çª—å£
                    windowData.element.classList.add('maximized');
                    windowData.maximized = true;
                }
            }
        }
        
        function closeWindow(windowId) {
            const windowData = windows[windowId];
            if (windowData) {
                windowData.element.classList.add('closing');
                setTimeout(() => {
                    windowData.element.style.opacity = '0';
                    windowData.element.style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        windowData.element.remove();
                        delete windows[windowId];
                        if (activeWindow === windowId) {
                            activeWindow = null;
                        }
                    }, 200);
                }, 500);
            }
        }
        
        function bringToFront(windowId) {
            if (activeWindow === windowId) return;
            
            if (activeWindow && windows[activeWindow]) {
                windows[activeWindow].element.style.zIndex = '100';
            }
            
            const windowData = windows[windowId];
            if (windowData) {
                windowData.element.style.zIndex = '200';
                activeWindow = windowId;
            }
        }
        
        // ==================== é«˜çº§åŠŸèƒ½ ====================
        
        // Alt+Tab çª—å£åˆ‡æ¢
        document.addEventListener('keydown', (e) => {
            if (isMobileDevice()) return;
            
            if (e.key === 'Alt') altPressed = true;
            if (e.key === 'Tab' && altPressed) {
                e.preventDefault();
                tabPressed = true;
                showAltTab();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (isMobileDevice()) return;
            
            if (e.key === 'Alt') altPressed = false;
            if (e.key === 'Tab') tabPressed = false;
            if (!altPressed) hideAltTab();
        });
        
        function showAltTab() {
            const overlay = document.getElementById('altTabOverlay');
            const windowsContainer = document.getElementById('altTabWindows');
            
            windowsContainer.innerHTML = '';
            Object.keys(windows).forEach((id, index) => {
                const win = windows[id];
                if (!win.minimized) {
                    const windowElement = document.createElement('div');
                    windowElement.style.cssText = `
                        background: white;
                        padding: 20px;
                        margin: 10px;
                        border: 3px solid ${id === activeWindow ? '#4A90E2' : '#ddd'};
                        cursor: pointer;
                        border-radius: 5px;
                        text-align: center;
                    `;
                    windowElement.onclick = () => switchToWindow(id);
                    windowElement.innerHTML = `
                        <div style="font-size: 24px;">${win.type === 'browser' || win.type === 'real-browser' ? 'ğŸŒ' : 'ğŸ“‹'}</div>
                        <div>${win.element.querySelector('.window-title').textContent}</div>
                    `;
                    windowsContainer.appendChild(windowElement);
                }
            });
            
            overlay.classList.add('active');
        }
        
        function hideAltTab() {
            document.getElementById('altTabOverlay').classList.remove('active');
        }
        
        function switchToWindow(windowId) {
            if (windows[windowId]) {
                windows[windowId].element.style.display = 'block';
                windows[windowId].minimized = false;
                bringToFront(windowId);
                hideAltTab();
            }
        }
        
        // å³é”®èœå• - ä»…ä¿ç•™å…³äºæŒ‰é’®
        function showContextMenu(e, appId, targetElement) {
            closeContextMenu();
            
            const contextMenu = document.createElement('div');
            contextMenu.className = 'context-menu';
            contextMenu.style.left = `${e.clientX}px`;
            contextMenu.style.top = `${e.clientY}px`;
            contextMenu.id = 'contextMenu';
            
            contextMenu.innerHTML = `
                <div class="context-menu-item" onclick="showAboutWindow()">
                    å…³äº(A)
                </div>
            `;
            
            document.body.appendChild(contextMenu);
            
            setTimeout(() => {
                document.addEventListener('click', closeContextMenu);
            }, 100);
        }
        
        function closeContextMenu() {
            const contextMenu = document.getElementById('contextMenu');
            if (contextMenu) contextMenu.remove();
            document.removeEventListener('click', closeContextMenu);
        }
        
        // æ˜¾ç¤ºå…³äºçª—å£
        function showAboutWindow() {
            windowCount++;
            const windowId = `window_${windowCount}`;
            
            const windowEl = document.createElement('div');
            windowEl.className = 'window open';
            windowEl.id = windowId;
            windowEl.style.top = '100px';
            windowEl.style.left = '100px';
            windowEl.style.width = '400px';
            windowEl.style.height = '300px';
            
            windowEl.innerHTML = `
                <div class="title-bar" id="${windowId}_titlebar">
                    <div class="window-icon">â„¹ï¸</div>
                    <div class="window-title">å…³äº èŒæ–°MTRæœåŠ¡å™¨</div>
                    <div class="window-controls">
                        <div class="control-btn close">Ã—</div>
                    </div>
                </div>
                <div class="window-content" style="text-align: center; padding: 30px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">ğŸŒ</div>
                    <h3 style="color: #0B58A2; margin-bottom: 15px;">èŒæ–°MTRæœåŠ¡å™¨</h3>
                    <p style="margin-bottom: 10px;">çª—å£æ¨¡æ‹Ÿå™¨</p>
                    <p style="margin-bottom: 20px; font-size: 14px; color: #666;">èŠ’ç‰¹çœæœåŠ¡å™¨ä¸“ç”¨ç‰ˆæœ¬</p>
                    <div style="border-top: 1px solid #ddd; padding-top: 20px; margin-top: 20px;">
                        <p style="font-size: 12px; color: #888;">ç‰ˆæœ¬ 1.0.0</p>
                        <p style="font-size: 12px; color: #888;">èŒæ–°MTRæœåŠ¡å™¨</p>
                    </div>
                </div>
            `;
            
            document.getElementById('desktop').appendChild(windowEl);
            
            // åˆå§‹åŒ–çª—å£æ•°æ®
            windows[windowId] = {
                element: windowEl,
                type: 'about',
                minimized: false,
                maximized: false,
                resizable: false
            };
            
            // è®¾ç½®çª—å£åŠŸèƒ½
            setupWindowFunctionality(windowEl, windowId);
            
            return windowId;
        }
        
        // ==================== å®ç”¨å‡½æ•° ====================
        
        // æ—¶é’Ÿæ›´æ–°
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('clock').textContent = `${hours}:${minutes}`;
        }
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œä¸è®¾ç½®è¿™äº›äº‹ä»¶
            if (isMobileDevice()) return;
            
            // å¼€å§‹èœå•æ§åˆ¶
            document.getElementById('startButton').addEventListener('click', (e) => {
                e.stopPropagation();
                document.getElementById('startMenu').classList.toggle('active');
            });
            
            document.addEventListener('click', (e) => {
                const startMenu = document.getElementById('startMenu');
                const startButton = document.getElementById('startButton');
                if (!startMenu.contains(e.target) && !startButton.contains(e.target)) {
                    startMenu.classList.remove('active');
                }
            });
            
            // çª—å£ç‚¹å‡»ç½®é¡¶
            document.addEventListener('click', (e) => {
                let target = e.target.closest('.window');
                if (target) {
                    bringToFront(target.id);
                }
            });
            
            // å®æ—¶æ—¶é’Ÿ
            setInterval(updateClock, 1000);
        }
        
        // åˆå§‹åŒ–ç³»ç»Ÿ
        window.addEventListener('load', init);
    </script>
</body>
</html>
